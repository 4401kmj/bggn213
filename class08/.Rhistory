# Save your input data file into your Project directory
fna.data <- "WisconsinCancer.csv"
# Complete the following code to input the data and store as wisc.df
wisc.df <- ___(fna.data, row.names=1)
# Save your input data file into your Project directory
fna.data <- "WisconsinCancer.csv"
# Complete the following code to input the data and store as wisc.df
wisc.df <- data.frame(fna.data, row.names=1)
# Save your input data file into your Project directory
fna.data <- "WisconsinCancer.csv"
# Complete the following code to input the data and store as wisc.df
wisc.df <- data.frame(fna.data, row.names=1)
wisc.df
# Save your input data file into your Project directory
fna.data <- "WisconsinCancer.csv"
# Complete the following code to input the data and store as wisc.df
wisc.df <- read.csv(fna.data, row.names=1)
wisc.df
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data, row.names=1)
wisc.df
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data, row.names=1)
wisc.df
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data)
wisc.df
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data, row.names=1)
wisc.df
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data)
wisc.df
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data, row.names=1)
wisc.df
View(wisc.df)
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data, row.names=1)
diagnosis <- as.factor(wisc.df$diagnosis)
wisc.data <- wisc.df[, -1]
diagnosis
wisc.data
# Q1.
nrow(wisc.data)
# Q2.
sum(diagnosis == "M")
# Q3.
table(wisc.data)
# Q3.
rownames(wisc.data)
# Q3.
colnames(wisc.data)
# Q3.
grep(colnames(wisc.data), "_mean")
# Q1.
nrow(wisc.data)
# Q2.
sum(diagnosis == "M")
# Q3.
sum(grepl("_mean", colnames(wisc.data)))
# Q1.
print("Q1 answer: " + nrow(wisc.data))
print(paste("Q1 answer:", nrow(wisc.data)))
print(paste("Q2 answer:", sum(diagnosis == "M")))
print(paste("Q3 answer:", sum(grepl("_mean", colnames(wisc.data)))))
wisc.pr <- prcomp(wisc.data, scale=TRUE)
wisc.pr <- prcomp(wisc.data, scale=TRUE)
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data, row.names=1)
diagnosis <- as.factor(wisc.df$diagnosis)
wisc.data <- wisc.df[, -1]
wisc.pr <- prcomp(wisc.data, scale=TRUE)
View(wisc.data)
View(wisc.data)
# Import data
fna.data <- "WisconsinCancer.csv"
wisc.df <- read.csv(fna.data, row.names=1)
diagnosis <- as.factor(wisc.df$diagnosis)
wisc.data <- wisc.df[, -1]
wisc.pr <- prcomp(wisc.data, scale=TRUE)
colMeans(wisc.data)
apply(wisc.data,2,sd)
wisc.pr <- prcomp(wisc.data, scale=TRUE)
wisc.pr <- prcomp(wisc.data, scale=TRUE)
diagnosis <- as.factor(wisc.df$diagnosis)
wisc.data <- wisc.df[, -1]
wisc.data <- subset(wisc.data, select = -X)
wisc.pr <- prcomp(wisc.data, scale=TRUE)
wisc.pr
wisc.pr <- prcomp(wisc.data, scale=TRUE)
wisc.pr$x
wisc.pr <- prcomp(wisc.data, scale=TRUE)
library(ggplot2)
ggplot(wisc.data, aes(PC1, PC2)) +
geom_point()
library(ggplot2)
ggplot(wisc.data$x, aes(PC1, PC2)) +
geom_point()
library(ggplot2)
ggplot(wisc.pr$x, aes(PC1, PC2)) +
geom_point()
ggplot(wisc.pr$x, aes(PC1, PC2, col=diagnosis)) +
geom_point()
wisc.pr
wisc.x
wisc.pr$x
wisc.pr$sdev
View(wisc.pr)
View(wisc.pr)
sum(wisc.pr$sdev)
wisc.pr$sdev[1] / sum(wisc.pr$sdev)
# 각 주성분의 분산
variances <- wisc.pr$sdev^2
# 전체 분산 중 각 주성분이 설명하는 비율
explained_var <- variances / sum(variances)
# 출력
explained_var
# 출력
sum(explained_var)
# 출력
explained_var[1]
# 출력
explained_var
variances <- wisc.pr$sdev^2
# 전체 분산 중 각 주성분이 설명하는 비율
explained_var <- (variances / sum(variances))[1]
# 출력
explained_var
summary(wisc.pr)
summary(wisc.pr)[1]
summary(wisc.pr)[2]
summary(wisc.pr)[3]
summary(wisc.pr)[4]
summary(wisc.pr)
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2))[1] * 100
explained_variance
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
explained_variance
cumsum(explained_variance)
cumsum(explained_variance) > 70
((cumsum(explained_variance) > 70) == True)[1]
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
((cumsum(explained_variance) > 70) == TRUE)[1]
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
(cumsum(explained_variance) > 70) == TRUE)
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
(cumsum(explained_variance) > 70) == TRUE
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
(cumsum(explained_variance) > 70)
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
which(cumsum(explained_variance) > 70), 1)
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
which((cumsum(explained_variance) > 70), 1)
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
which(cumsum(explained_variance) > 70)
explained_variance <- (wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100
which(cumsum(explained_variance) > 70)[1]
which(cumsum((wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)) * 100) > 70)[1]
summary(wisc.pr)
a <- summary(wisc.pr)
a$importance
a <- summary(wisc.pr)
View(a)
View(a)
a[['importance']]
a[['importance']][1,]
a[['importance']][2,]
a[['importance']][3,]
a[['importance']][3,1]
a[['importance']][3,2]
a[['importance']][3,]
a[['importance']][3,] > 70
which(a[['importance']][3,] > 70)
summary(wisc.pr)
biplot(wisc.pr)
ggplot(wisc.pr$x, aes(PC1, PC3, col=diagnosis)) +
geom_point()
library(ggplot2)
ggplot(wisc.pr$x, aes(PC1, PC3, col=diagnosis)) +
geom_point() +
labs("PC1", "PC3")
library(ggplot2)
ggplot(wisc.pr$x, aes(PC1, PC3, col=diagnosis)) +
geom_point() +
labs(x="PC1", y="PC3")
wisc.pr$rotation[, 1]
wisc.pr$rotation[, 1]['concave.points_mean;]
wisc.pr$rotation[, 1]['concave.points_mean']
wisc.pr$rotation[, 1]['concave.points_mean']
plot(explained)
explained <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
plot(explained)
explained <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
ggplot(explained)
explained <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
plot(1:50, explained)
explained <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
plot(1:length(explained), explained)
explained <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
plot(1:length(explained), explained, xlab = 'Principal Component')
explained <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
plot(1:length(explained), explained, xlab = 'Principal Component', ylab = 'Proportion of Variance Explained')
explained <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
plot(1:length(explained), explained, xlab = 'Principal Component', ylab = 'Explained Variance')
pve <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
# Plot variance explained for each principal component
plot(pve, xlab = "Principal Component",
ylab = "Proportion of Variance Explained",
ylim = c(0, 1), type = "o")
pve <- wisc.pr$sdev^2 / sum(wisc.pr$sdev^2)
# Plot variance explained for each principal component
plot(pve, xlab = "Principal Component",
ylab = "Explained Variance",
ylim = c(0, 1), type = "o")
data.scaled <- scale(wisc.data)
data.dist <- dist(data.scaled)
wisc.hclust <- hclust(data.dist, method="complete")
plot(wisc.hclust)
abline(18, col="red", lty=2)
data.scaled <- scale(wisc.data)
data.dist <- dist(data.scaled)
wisc.hclust <- hclust(data.dist, method="complete")
plot(wisc.hclust)
abline(18, col="red", lty=2)
data.scaled <- scale(wisc.data)
data.dist <- dist(data.scaled)
wisc.hclust <- hclust(data.dist, method="complete")
plot(wisc.hclust)
abline(18, col="red", lty=2)
plot(wisc.hclust)
abline(18, col="red", lty=2)
sort(wisc.hclust$height)
height_for_4 <- heights[which(num_clusters == 4)[1]]
plot(wisc.hclust)
abline(h = 18, col="red", lty=2)
plot(wisc.hclust)
abline(h = 19, col="red", lty=2)
plot(wisc.hclust)
abline(h = 19.5, col="red", lty=2)
wisc.hclust.clusters <- cutree(wisc.hclust, k = 4)
table(wisc.hclust.clusters, diagnosis)
res <- table(wisc.hclust.clusters, diagnosis)
res
for (kk in 2:10){
wisc.hclust.clusters <- cutree(wisc.hclust, k = 4)
res <- table(wisc.hclust.clusters, diagnosis)
res
}
for (kk in 2:10){
wisc.hclust.clusters <- cutree(wisc.hclust, k = 4)
res <- table(wisc.hclust.clusters, diagnosis)
print(res)
}
for (kk in 2:10){
wisc.hclust.clusters <- cutree(wisc.hclust, k = kk)
res <- table(wisc.hclust.clusters, diagnosis)
print(res)
}
min(res)
colmin(res)
apply(res, 1, min)
sum(apply(res, 1, min))
res_all = []
res_all <- []
res_all <- c()
for (kk in 2:10) {
wisc.hclust.clusters <- cutree(wisc.hclust, k = kk)
res <- table(wisc.hclust.clusters, diagnosis)
res_all <- c(res_all, sum(apply(res, 1, min)))
}
res_all <- c()
for (kk in 2:10) {
wisc.hclust.clusters <- cutree(wisc.hclust, k = kk)
res <- table(wisc.hclust.clusters, diagnosis)
res_all <- c(res_all, sum(apply(res, 1, min)))
}
plot(2:10, res_all)
res_all <- c()
for (kk in 2:10) {
wisc.hclust.clusters <- cutree(wisc.hclust, k = kk)
res <- table(wisc.hclust.clusters, diagnosis)
res_all <- c(res_all, sum(apply(res, 1, min)))
}
plot(2:10, res_all, xlabe='num of clusters', ylabel='out-of-cluster datapoints')
res_all <- c()
for (kk in 2:10) {
wisc.hclust.clusters <- cutree(wisc.hclust, k = kk)
res <- table(wisc.hclust.clusters, diagnosis)
res_all <- c(res_all, sum(apply(res, 1, min)))
}
plot(2:10, res_all, xlab='num of clusters', ylab='out-of-cluster datapoints')
d <- dist(wisc.pr$x[, 1:3])
hclust(d, method = "ward.D2")
d <- dist(wisc.pr$x[, 1:3])
wisc.pr.hclust <- hclust(d, method = "ward.D2")
d <- dist(wisc.pr$x[, 1:3])
wisc.pr.hclust <- hclust(d, method = "ward.D2")
plot(wisc.pr.hclust)
table(grps)
grps <- cutree(wisc.pr.hclust, k = 70)
table(grps)
grps <- cutree(wisc.pr.hclust, k = 70)
table(grps)
table(diagnosis)
grps <- cutree(wisc.pr.hclust, k = 2)
table(grps)
table(diagnosis)
table(grps, diagnosis)
grps <- cutree(wisc.pr.hclust, k = 2)
table(grps, diagnosis)
wisc.hclust.clusters <- cutree(wisc.hclust, k = 4)
table(wisc.hclust.clusters, diagnosis)
print("Previous (raw data) version\n")
table(wisc.hclust.clusters, diagnosis)
print("Current (pca data) version\n")
table(wisc.pr.hclust, diagnosis)
print("Previous (raw data) version\n")
table(wisc.hclust.clusters, diagnosis)
print("Current (pca data) version\n")
table(grps, diagnosis)
grps1 <- cutree(wisc.hclust, k = 4)
table(grps1, diagnosis)
grps2 <- cutree(wisc.pr.hclust, k = 2)
table(grps2, diagnosis)
print("Previous (raw data) version\n")
table(grps1, diagnosis)
print("Current (pca data) version\n")
table(grps2, diagnosis)
print("Previous (raw data) version")
table(grps1, diagnosis)
print("Current (pca data) version")
table(grps2, diagnosis)
print("Previous (raw data) version")
grps1 <- cutree(wisc.hclust, k = 2)
table(grps1, diagnosis)
print("Current (pca data) version")
table(grps2, diagnosis)
print("Previous (raw data) version")
grps1 <- cutree(wisc.hclust, k = 2)
table(grps1, diagnosis)
print("Current (pca data) version")
table(grps2, diagnosis)
plot(wisc.hclust)
abline(h = 19.5, col="red", lty=2)
grps1 <- cutree(wisc.hclust, k = 4)
table(grps1, diagnosis)
wisc.pr <- prcomp(wisc.data, scale=FALSE)
d <- dist(wisc.pr$x[, 1:3])
wisc.pr.hclust <- hclust(d, method = "ward.D2")
plot(wisc.pr.hclust)
