rnorm(1000)
hist(rnorm(1000))
hist(rnorm(30, -3))
y <- rnorm(30, mean = 3)
scatter(x, y)
x <- c(rnorm(30, mean=-3), rnorm(30, mean = 3))
y <- c(rnorm(30, mean=-3), rnorm(30, mean = 3))
scatter(x, y)
plot(x, y)
y <- rev(x)
cbind(x, y)
plot(x)
head(x)
x <- c(rnorm(30, mean=-3), rnorm(30, mean = 3))
y <- rev(x)
x <- cbind(x, y)
head(x)
plot(x)
kmeans(x, centers = 2)
k <- kmeans(x, centers = 2)
k$size
> Q. How big are the clusters
k$size
k$cluster
ggplot2(aes(x=x[1,], y=x[2,]), color = k$cluster
ggplot2(aes(x=x[1,], y=x[2,]), color = k$cluster)
library(ggplot2)
library(ggplot2)
ggplot2(aes(x=x[1,], y=x[2,]), color = k$cluster)
ggplot(aes(x=x[1,], y=x[2,]), color = k$cluster)
plot(x=x[1,], y=x[2,], color = k$cluster)
plot(x=x[1,], y=x[2,], col = k$cluster)
plot(x, col = k$cluster)
plot(x, col = c("Red", "Blue"))
plot(x, col = k$cluster)
points(k$clusters, col="blue", pch=15)
plot(x, col = k$cluster)
points(k$clusters, col="blue", pch=15)
points(k$centers, col="blue", pch=15)
plot(x, col = k$cluster)
points(k$centers, col="blue", pch=15)
plot(k$centers, col="blue", pch=15)
plot(x, col = k$cluster) +
points(k$centers, col="blue", pch=15)
library(ggplot2)
plot(x, col = k$cluster) +
points(k$centers, col="blue", pch=15)
k2 <- kmeans(x, centers = 2)
plot(x, col = k2$cluster) +
points(k2$centers, col="blue", pch=15)
k2 <- kmeans(x, centers = 2)
plot(x, col = k2$cluster) +
points(k2$centers, col="blue", pch=15)
plot(x, col = k2$cluster) +
points(k2$centers, col="blue", pch=15)
k2 <- kmeans(x, centers = 4)
plot(x, col = k2$cluster) +
points(k2$centers, col="blue", pch=15)
k2 <- kmeans(x, centers = 4)
plot(x, col = k2$cluster) +
points(k2$centers, col="blue", pch=15)
k$tot.withinss
k_all <- 1:6
with_all <- c(len(k_all))
with_all <- c(length(k_all))
with_all
with_all <- rep(0, length(k_al))
with_all <- rep(0, length(k_all))
k_all
k_all[k] = km$withness
k_all <- 1:6
k_all <- 1:6
with_all <- rep(0, length(k_all))
for k in k_all{
for (k in k_all){
km <- kmeans(x, centers=k)
k_all[k] = km$withiness
}
k_all <- 1:6
with_all <- rep(0, length(k_all))
for (k in k_all) {
km <- kmeans(x, centers = k)
with_all[k] <- km$tot.withinss
}
k_all
with_all
plot(with_all, typ="b")
plot(with_all, typ="b")
dist(x)
hc
d <- dist(x)
hc <- hclust(d)
hc
plot(hc)
abline(h=7, col="red")
plot(hc)
abline(h=7, col="red")
plot(hc) +
abline(h=7, col="red")
plot(hc) +
abline(h=7, col="red")
cutree(hc, h=7)
grps
grps <- cutree(hc, h=7)
grps
plot(x, col = k2$grps)
grps <- cutree(hc, h=7)
grps
plot(x, col = k2$grps)
plot(x, col = grps)
plot(hc)
abline(h = 7, col = "red")
plot(hc)
abline(h = 7, col = "red")
k2 <- kmeans(x, centers = 4)
plot(x, col = k2$cluster)
points(k2$centers, col="blue", pch=15)
pheatmap(x)
pheatmap(x)
library(pheatmap)
pheatmap(x)
library(pheatmap)
library(pheatmap)
install.packages("pheatmap")
library(pheatmap)
pheatmap(x)
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url)
야ㅡ(ㅌ)
dim(x)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url, row.names=1)
dim(x)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
# Create grouped bar plot
library(ggplot2)
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col(position = "dodge") +
theme_bw()
# Create grouped bar plot
library(ggplot2)
library(tidyr)
install.packages("tidybar")
install.packages("tidyr")
# Create grouped bar plot
library(ggplot2)
library(tidyr)
# Convert data to long format for ggplot with `pivot_longer()`
x_long <- x |>
tibble::rownames_to_column("Food") |>
pivot_longer(cols = -Food,
names_to = "Country",
values_to = "Consumption")
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col(position = "dodge") +
theme_bw()
# Create grouped bar plot
library(ggplot2)
library(tidyr)
# Convert data to long format for ggplot with `pivot_longer()`
x_long <- x |>
tibble::rownames_to_column("Food") |>
pivot_longer(cols = -Food,
names_to = "Country",
values_to = "Consumption")
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col(position = "stack") +
theme_bw()
head(x)
pairs(x, col=rainbow(nrow(x)), pch=16)
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url, row.names=1)
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url, row.names=1)
head(x)
pheatmap(as.matrix(x))
# Create a data frame for plotting
df <- as.data.frame(pca$x)
pca <- prcomp( t(x) )
summary(pca)
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = pca$x) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = factor(pca$x) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = factor(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
pca$x
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = group) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = factor(c("a", "b", "c" ,"d"))) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = factor(df$Country)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
library(ggplot)
library(ggplot2)
cols <- c("orange", "red", "blue", "darkgreen")
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col = cols) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
library(ggplot2)
cols <- c("orange", "red", "blue", "darkgreen")
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, col = cols) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
pca$rotation
ggplot(pca$rotation) +
aes(PC1, rownames(pca$rotation))
ggplot(pca$rotation) +
aes(PC1, rownames(pca$rotation)) +
geom_col()
ggplot(pca$rotation) +
aes(PC2, rownames(pca$rotation)) +
geom_col()
