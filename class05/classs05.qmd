---
title: "Class05: Data Viz with GGPLOT"
author: "Minjun Kang (A69042800)"
format: gfm
---

Today we playing with plotting and graphics in R.

There are lots of ways to make cool figures in R. 
There is "base" R graphics (`plot()`, `hist()`, `boxplot()` etc.)

There is also add-on packages, like **ggplot**

```{r}
head(cars)
```
Let's plot this with "base" R. 

```{r}
plot(cars)
```
```{r}
head(mtcars)
```
Let's plot `mpg` vs `disp`

```{r}
plot(mtcars$mpg, mtcars$disp, pch=16)
```
```{r}
hist(mtcars$mpg)
```

## GGPLOT

The main function is the ggplot2 package is **ggplot()**.
First I need to install the **ggplot2** package. 
I can install any package with the function `install.packages()`.

> **N.B.** I never want to run `install.packages()` in m yquarto source document!!

```{r}
library(ggplot2)
ggplot(cars, aes(speed, dist)) +
geom_point()
```
```{r}
ggplot(cars) +
  aes(speed) +
  geom_histogram()
```

Every ggplot needs at least 3 things:
- The **data** (given with `ggplot(cars)`)
- The **aes** (given with `aes(x, y)`)
- The **geom** (given by `geom_point()`)

> For simple canned graphs "base" R is nearly always faster


### Adding more layers

Let's add a line and a tile, subtitle and caption as well as custom axis labels

```{r}
ggplot(cars) +
  aes(speed, dist) +
  geom_point() +
  geom_smooth(method="lm", se=FALSE) +
  labs(title = "Silly Plot", x = "Speed (MPH)", y = "Distance (ft)", caption = "when is tea time anyway???") +
  theme_bw()
```

## Gene example

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

> Q1. How many genes are in this wee dataset?

There are `r nrow(genes)` genes in this dataset

> Q2. How many "up" regulated genes are there?

There are `sum(genes$State == "up")` genes in this dataset. 

```{r}
sum(genes$State == "up")
```

```{r}
table(genes$State)
```

```{r}
library(ggrepel)
ggplot(genes) + 
    aes(x=Condition1, y=Condition2, color = State, label=Gene) + 
    geom_point() +
    scale_color_manual(values=c("purple", "orange", "blue")) +
    geom_text_repel(max_overlaps = 10) + 
    theme_bw()
```

## Going Further

Playing with some different layers and the gapmider dataset...

```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
tail(gapminder)
```

A first plot

```{r}
ggplot(gapminder)+
  aes(y=lifeExp, x=gdpPercap, col=continent) +
  geom_point() +
  facet_wrap(~continent)
```

My favorite plot
```{r}
ggplot(gapminder)+
  aes(lifeExp, fill = continent) +
  geom_histogram()
```

