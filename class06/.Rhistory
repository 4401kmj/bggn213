x + 1
add <- function(x){
x + 1
}
add <- function(x){
x + 1
}
add(10)
add <- function(x, y=1){
x + y
}
add(10, 100)
sample(c("A", "C", "G", "T"), size=3)
sample(c("A", "C", "G", "T"), size=3)
sample(c("A", "C", "G", "T"), size=5, replace=True)
sample(c("A", "C", "G", "T"), size=5, replace=TRUE)
paste(sample(c("A", "C", "G", "T"), size=5, replace=TRUE))
v <- sample(c("A", "C", "G", "T"), size=5, replace=TRUE)
paste(v, collapse = "")
v <- sample(c("A", "C", "G", "T"), size=5, replace=TRUE)
paste(v, collapse = "")
generate_dna <- function(size = 50){
v <- sample(c("A", "C", "G", "T"), size, replace=TRUE)
paste(v, collapse = "")
}
generate_dna(60)
```{r}
fasta = FALSE
fasta = FALSE
fasta <- FALSE
if (fasta){
cat("HELLO You!")
}
generate_dna <- function(size = 50, fasta=TRUE){
v <- sample(c("A", "C", "G", "T"), size, replace=TRUE)
if (fasta){
paste(v, collapse = "")
}
}
generate_dna(60, TRUE)
generate_dna(60, FALSE)
generate_dna <- function(size = 50, fasta=TRUE){
v <- sample(c("A", "C", "G", "T"), size, replace=TRUE)
if (fasta){
paste(v, collapse = "")
} else{
v
}
}
generate_dna(60, FALSE)
generate_dna <- function(size = 50, fasta=TRUE){
v <- sample(c("A", "C", "G", "T"), size, replace=TRUE)
s <- paste(v, collapse = "")
if (fasta){
return(s)
} else{
return(v)
}
}
```{r}
generate_dna <- function(size = 50, fasta=TRUE){
v <- sample(c("A", "C", "G", "T"), size, replace=TRUE)
s <- paste(v, collapse = "")
if (fasta){
return(s)
} else{
return(v)
}
}
generate_dna(60, FALSE)
generate_dna(60, TRUE)
generate_protein(50)
generate_protein <- function(size = 50, fasta = TRUE) {
# 20 standard amino acids (single-letter codes)
amino_acids <- c("A", "R", "N", "D", "C",
"E", "Q", "G", "H", "I",
"L", "K", "M", "F", "P",
"S", "T", "W", "Y", "V")
# Sample amino acids
v <- sample(amino_acids, size, replace = TRUE)
s <- paste(v, collapse = "")
if (fasta) {
return(s)
} else {
return(v)
}
}
```{r}
generate_protein(50)
length <- 6:12
for (i in length){
cat(i)
}
length <- 6:12
length <- 6:12
for (i in length){
cat(i)
generate_protein(i)
}
for (i in length){
cat(i)
a <- generate_protein(i)
cat(a)
}
cat('\n')
for (i in length){
cat(i)
a <- generate_protein(i)
cat(a)
cat("\n")
}
for (i in length){
cat(">", i, "\n", sep="")
a <- generate_protein(i)
cat(a)
cat("\n")
}
## Function
grade <- function(scores) {
# 1. Omitting NA
scores_no_na <- na.omit(scores)
if (length(scores_no_na) < length(scores)) {
# If there is NA
final_scores <- scores_no_na
} else {
# If there is no NA
final_scores <- scores_no_na[-which.min(scores_no_na)]
}
# Calculating mean
mean(final_scores)
}
## Example
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
grade(student1)
grade(student2)
grade(student3)
grade(student1)
grade(student2)
grade(student3)
# Read csv file
grades <- read.csv("https://tinyurl.com/gradeinput")
head(grades)
# calculation
std_grades <- apply(grades[,-1], 1, grade)
std_grades
# calculation
std_grades <- apply(grades[,-1], 1, grade)
std_best <- which.max(std_grades)
paste("Student ", std_best, "is the best")
paste("Student", std_best, "is the best")
print(grades$X[std_best])
sapply(lengths, generate_protein)
generate_protein <- function(size = 50, fasta = TRUE) {
# 20 standard amino acids (single-letter codes)
amino_acids <- c("A", "R", "N", "D", "C",
"E", "Q", "G", "H", "I",
"L", "K", "M", "F", "P",
"S", "T", "W", "Y", "V")
# Sample amino acids
v <- sample(amino_acids, size, replace = TRUE)
s <- paste(v, collapse = "")
if (fasta) {
return(s)
} else {
return(v)
}
}
sapply(lengths, generate_protein)
generate_protein <- function(size = 50, fasta = TRUE) {
# 20 standard amino acids (single-letter codes)
amino_acids <- c("A", "R", "N", "D", "C",
"E", "Q", "G", "H", "I",
"L", "K", "M", "F", "P",
"S", "T", "W", "Y", "V")
# Sample amino acids
v <- sample(amino_acids, size, replace = TRUE)
s <- paste(v, collapse = "")
if (fasta) {
return(s)
} else {
return(v)
}
}
sapply(length, generate_protein)
# Mean values per each homework
hw_means <- colMeans(grades[,-1], na.rm = TRUE)
# toughest hw
hw_tough <- which.min(hw_means)
# print
names(hw_means)[hw_tough]
# Find correlations for each homework
hw_corr <- sapply(grades[,-1], function(hw) cor(hw, std_grades, use="complete.obs"))
# Return best homework for maximum correlation
best_predictor <- which.max(hw_corr)
most_predictive_hw <- names(hw_corr)[best_predictor]
print(names(hw_corr)[best_predictor])
# Can you improve this analysis code?
library(bio3d)
s1 <- read.pdb("4AKE") # kinase with drug
s2 <- read.pdb("1AKE") # kinase no drug
s3 <- read.pdb("1E4Y") # kinase with drug
s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s1, chain="A", elety="CA")
s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b
plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")
library(bio3d)
# Function to analyze a protein (with or without drug)
analyze_protein <- function(pdb_id, chain="A", element="CA", ylab="B-factor")
{
# Read PDB structure
pdb <- read.pdb(pdb_id)
# Trim to specified chain and element type (default: alpha carbons)
pdb_chain <- trim.pdb(pdb, chain=chain, elety=element)
# Extract B-factors
b_factors <- pdb_chain$atom$b
# Optional plot
plotb3(b_factors, sse=pdb_chain, typ="l", ylab=ylab,
main=paste("B-factors for", pdb_id))
}
# Example usage: three kinases with/without drug
res1 <- analyze_protein("4AKE")  # kinase with drug
res2 <- analyze_protein("1AKE")  # kinase no drug
res3 <- analyze_protein("1E4Y")  # kinase with drug
